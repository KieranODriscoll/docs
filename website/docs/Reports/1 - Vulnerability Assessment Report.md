---
Author: Kieran O'Driscoll
Prepared for: School Midterm Assignment
---
# Vulnerability Assessment Report
## Purpose

The purpose of this document is to outline the vulnerability assessment plan that will be undertaken by OD Company for RandomCompany ( “the client” ). The client has asked for an assessment to be done of their systems as they have quickly scaled their network to handle the increased growth they are seeing. A trade-off was made to keep up with the growth at the expense of security, and the vulnerability assessment will help address this.

## Scope

The client has created a clone of their network for the purpose of testing. The assessment will address all systems on the cloned network unless otherwise stated. The network to be used is on the 10.0.69.0/24 subnet with the following systems out of scope:
- PFSense (10.0.69.1)
- Kali (10.0.69.9)
- Wazuh (10.0.69.4)

The remaining addresses in the subnet are within scope. Each system that is in scope will be subjected to a vulnerability scan and those vulnerabilities will be analysis based on severity. This report will focus on high and critical severities and will not show proof of exploitation for each vulnerability. Lastly, this report will contain a list of high or critical severities for the client to prioritize within its’ IT team.

## Objective

The objective of the assessment is to provide an analysis of the current state of the client’s infrastructure and provide a guide to help prioritize the areas of the network that need the most hardening. OD Company will have until February 25, 2024, to complete the vulnerability assessment and process the accompanying report. The vulnerability assessment and report will be the responsibility of OD Company with the client providing the cloned network infrastructure for use in the assessment.

## Tools

The following tools will be used to assess the vulnerability of the network:
- Nmap and its accompanying scripting engine

Nmap will be configured to scan 1-9090 for TCP ports and the vuln script will be used to scan the systems for known vulnerabilities. It will use the stealth scan approach and a timing of -T2 in attempt to avoid detection.

### Asset Classification / Prioritization

After an initial scan using nmap to determine information about the hosts that are on the network, it has been found that the following machines are accessible on the network:
- 10.0.69.5 – Windows 11
- 10.0.69.6 – Windows Server 2022
- 10.0.69.10 – Linux
- 10.0.69.11 – Linux 2.6.X
- 10.0.69.8 – Ubuntu Linux
- 10.0.69.12 – Linux 5.X

The windows systems are of high importance because they hold critical infrastructure (Windows Server) and an employee workstation. Both systems have a high probability of housing sensitive information and are good candidates for denial-of-service in order to distribute business operations. The Linux 2.6.X will be given a high priority in the assessment as the system’s kernel is old and may contain a large amount of known vulnerabilities that might give attackers a foothold into the company network.

## Vulnerability Analysis

### 10.0.69.5 – Windows 11

The assessment of the Windows 11 machine does not uncover any known vulnerabilities. Windows defender is doing a good job filtering out any requests to the commonly used ports on the system. The only accessible port by nmap is 5357 which is the Web Services on Devices API application. Someone may be able to utilize this port for something as it is an opening into the system, but nothing glaring appears. See Appendix 1 for the results of the scans.

### 10.0.69.6 – Windows Server

The assessment of the Windows Server machine does not uncover any known vulnerabilities. Windows defender is doing a good job filtering out any requests to the commonly used ports on the system. The only accessible port by nmap is 5985 which is wsman, WS-Management, allowing the remote management of systems. While no known vulnerabilities are detected by nmap for wsman, this is still an opening into the system that may be exploitable, especially if administrator profiles have weak passwords that could allow for brute-forcing access to the management system. See Appendix 2 for the results of the scans.

### 10.0.69.8 – Ubuntu Linux

The assessment of the Ubuntu Linux server shows a large number of potential vulnerabilities related to port 80. The web server is running on this port is Apache and is version 2.4.52. Version 2.4.52 has the following critical and high vulnerabilities:
- [CVE-2022-22720](https://www.cvedetails.com/cve/CVE-2022-22720/ "CVE-2022-22720 security vulnerability details") – CVSS: 9.8, HTTP Request Smuggling
- [CVE-2022-23943](https://www.cvedetails.com/cve/CVE-2022-23943/ "CVE-2022-23943 security vulnerability details") – CVSS: 9.8, Overwrite heap memory with attacker data.
- [CVE-2022-31813](https://www.cvedetails.com/cve/CVE-2022-31813/ "CVE-2022-31813 security vulnerability details") – CVSS: 9.8, Bypass IP based authentication
- [CVE-2023-25690](https://www.cvedetails.com/cve/CVE-2023-25690/ "CVE-2023-25690 security vulnerability details") – CVSS: 9.9, HTTP Request Smuggling
- [CVE-2022-22721](https://www.cvedetails.com/cve/CVE-2022-22721/ "CVE-2022-22721 security vulnerability details") – CVSS: 9.1, Buffer overflow on 32-bit systems
- [CVE-2022-28615](https://www.cvedetails.com/cve/CVE-2022-28615/ "CVE-2022-28615 security vulnerability details") – CVSS: 9.1, DOS or disclosure of information
- [CVE-2022-36760](https://www.cvedetails.com/cve/CVE-2022-36760/ "CVE-2022-36760 security vulnerability details") – CVSS: 9.0, HTTP Request Smuggling

The webserver is also at risk of SQL injection, cross domain policy vulnerabilities and potential CSRF vulnerabilities associated with the bWAPP login form. To see the full extent of the vulnerabilities associated with the public facing web server, see appendix 3. The version of Apache running on this system is vulnerable to authentication bypassing which could result in the loss of confidentiality of the assets behind the authentication. It is also vulnerable to buffer overflow which could result in the disclosure of information or overriding memory with attacker data. This results in the denial of the availability of the application or the potential for malicious code loading into the heap. This application is at extreme risk to the confidentiality, integrity and availability triad and must be remediated immediately to prevent severe consequences. See appendix 3 for a portion of the scan results.

### 10.0.69.10 – Linux (3.2-4.9)

The assessment of the Linux server shows that it has 6 services running with external access. Appendix 4 shows a list of the ports and the services running on them. The scan also shows a 98% confidence that the machine is running a Linux kernel between versions 3.2 and 4.9. The crucial services that need attention are ProFTPD and Drupal on the webserver. Both have 10.0 score vulnerabilities and will need immediate attention. The following critical and high vulnerabilities give an idea of the state of the system and the importance of updating it:
- [CVE-2015-3306](https://www.cvedetails.com/cve/CVE-2015-3306/) – CVSS: 10, Arbitrary read/write of files to server
- [CVE-2015-5600](https://www.cvedetails.com/cve/CVE-2015-5600/ "CVE-2015-5600 security vulnerability details") – CVSS: 8.5, Denial of service
- [SA-CONTRIB-2016-039](https://www.drupal.org/node/2765575) – Highly Critical, Remote code execution
- [CVE-2015-5600](https://www.cvedetails.com/cve/CVE-2015-5600/ "CVE-2015-5600 security vulnerability details") – CVSS: 8.5, Brute force or denial of service
- [CVE-2023-25690](https://www.cvedetails.com/cve/CVE-2023-25690/ "CVE-2023-25690 security vulnerability details") – CVSS: 9.8, HTTP Request Smuggling

The system has 2 web services running on port 80 and 8080. Both web services have potential SQL injection vulnerabilities, and CSRF token vulnerabilities. See appendix 5 for a portion of the scan results.

### 10.0.69.11 – Linux (2.6.x)

The assessment of the Linux server running kernel version 2.6.x has 17 ports opens. This is a very large attack surface and opens the network to many vulnerabilities. See appendix 6 for a list of services running on the system. This system is vulnerable to the same ProFTPD vulnerability that 10.0.69.10 is vulnerable. In addition, the OpenSSL version used across various services on the system has vulnerabilities that can result in a man-in-the-middle attack and the reading of plaintext when it should be encrypted. The following vulnerabilities give an idea of the vulnerable state of the system:
- [CVE-2015-4000](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000) – CVSS: 4.3, Man in the middle
- [CVE-2010-4478](https://www.cvedetails.com/cve/CVE-2010-4478/) – CVSS: 7.5, Bypass authentication criteria
- [CVE-2011-3192](https://www.cvedetails.com/cve/CVE-2011-3192/ "CVE-2011-3192 security vulnerability details") – CVSS: 7.8, Denial of service
- [CVE-2017-3167](https://www.cvedetails.com/cve/CVE-2017-3167/ "CVE-2017-3167 security vulnerability details") – CVSS: 7.5, Authentication restrictions bypass

Similar to the other Linux systems, the web services are potentially susceptible to SQL injection and CSRF token vulnerabilities. One of the more important aspects is the kernel version is extremely out of date and is vulnerable to the following:
- [CVE-2015-8812](https://www.cvedetails.com/cve/CVE-2015-8812/ "CVE-2015-8812 security vulnerability details") – CVSS: 10.0, Remote code execution or denial of service
- [CVE-2023-5178](https://www.cvedetails.com/cve/CVE-2023-5178/ "CVE-2023-5178 security vulnerability details") – CVSS: 9.8, Remote code execution or local privilege escalation
- [CVE-2023-32254](https://www.cvedetails.com/cve/CVE-2023-32254/ "CVE-2023-32254 security vulnerability details") – CVSS: 9.8, Remote code execution or local privilege escalation

See appendix 7 for a portion of the vulnerability scan.

### 10.0.69.12 – Linux (5.X) - Android

From the initial scan of the system, we can determine that this is an Android system. The results of the scan can be found in appendix 8. The only port open is 5555, which is most likely related to the Android Debug Bridge. A vulnerability scan does not show any known vulnerabilities for the device. Port 5555 open could be a way into the device but usually utilizing the debug bridge requires steps such as developer mode enabled and physical access to the device. There is the potential for ADB over wifi, but that requires human interaction to setup through the command line.

## Remediation

### 10.0.69.5 – Windows 11

The Windows 11 server is currently in a good state and needs little in implementing fixes to increase the security of the system. A low priority task should be to assess the open port containing the wsdapi service and its necessity in being externally exposed. If it is required, research should be conducted to ensure best practices are followed in securing the service including but not limited to ensuring the service is kept up-to-date and monitoring if any zero-day vulnerabilities are discovered. The remaining uncertainty resulting in the externally exposed port will have to be accepted risk.

### 10.0.69.6 – Windows Server

The Windows Server is currently in a good state and needs little in implementing fixes to increase the security of the system. A low priority task should be to assess the open port containing the WS-Management service and its necessity in being externally exposed. If it is required, research should be conducted to ensure best practices are followed in securing the service. This includes but is not limited to ensuring the service is kept up-to-date and monitoring for any zero-day vulnerabilities discovered. Additionally, a strong password policy should be implemented for all users to prevent access to the management system through weak credentials. This is especially crucial for any account that has Admin privileges. The remaining uncertainty resulting in the externally exposed port will have to be accepted risk.

### 10.0.69.8 – Ubuntu Linux

The Ubuntu Linux system is vulnerable because of its externally exposed webserver. It is susceptible to a number of critical vulnerabilities related to the Apache version. In addition, the web site is potentially vulnerable to SQL injection and CSRF vulnerabilities. To remediate the insecurity, it is imperative that the webserver is upgraded Apache to get the latest security updates. In addition, the website that is being hosted should undergo a security assessment by the developers to address any potential vulnerabilities related to SQL injection and CSRF tokens.

### 10.0.69.10 – Linux (3.2-4.9)

The Linux system is vulnerable across multiple services that are running on the machine. ProFTPD and Apache should be updated to the latest available versions. In addition, it is highly likely that the kernel it is running on is vulnerable to root escalation privileges such as dirty cow (CVE-2016-5195) and polkit (CVE-2021-4034) which if combined with other vulnerabilities listed above, could result in unauthorized root access to the system. It is highly recommended that the services running on the system are updated to the latest versions available to take advantage of security patches. In addition, it is important to ensure that the system operating system is updated to the latest kernel. If that is not possible due to some legacy requirements, ensure that the kernel is at the latest security patch available and other mitigation mechanisms are implemented to protect the system. Mitigation mechanisms could range from removing external facing services and keep them within the intranet, implementing an intrusion prevention system or depending on how critical the system is, keeping it air gapped from all environments. Lastly, the content hosted by the web server will need to undergo a security review with the developers to ensure any potential SQL injections are patched and the third-party services, such as Durpal, are up to date to prevent remote code execution.

### 10.0.69.11 – Linux 2.6.x

As with the other Linux systems above, it is highly recommended that services are updated to the latest version to take advantage of security updates. In addition, the Linux kernel is severely out of date and should be upgraded to avoid well-known exploits being used against the system to gain unauthorized root access. The system has a number of open ports that open it up to a larger attack surface and it is recommended that the needs of the system be reviewed to see if it is possible to shrink the attack surface making it easier to stay on top of keeping the rest up to date. If the system is home to critical applications that are no longer supported, then extra measures should be looked at to ensure the system is protected. Based on the age of the kernel, it would be recommended, that if it is a critical component, it should be at minimum kept internal with no outside access. However, this does not prevent an attacker from pivoting to the vulnerable once inside the network and the best course of action, if possible, should be to airgap the system.

## 10.0.69.12 – Linux (5.X) - Android

The android system does not have anything obvious in terms of vulnerabilities. No remediation is recommended at this time.

## Further Recommendations

Security is never finished; it is an ongoing process that requires commitment from management and IT. In order to ensure that the client is always up to date on the latest security recommendations, it is recommended that the client undergo regular vulnerability assessments. Conducting regular scans using tools such as OpenVAS will allow the IT department to regularly get a report of what vulnerabilities are on their systems and can then plan and prioritize remediation efforts. In addition, it important to implement security policies across the entire organization. By ensuring that comprehensive policies are implemented and regularly communicated to all employees, everyone can do their part for protecting the assets of the company. Lastly, it is important that those policies are constantly revisited based on assessment findings and the changing security landscape. Ensuring that policies are not out of date and reflect the current needs of the organization is crucial for keeping a strong security posture.

## Appendices

### Appendix 1 – Windows 11 Scan

![Pasted_image_20241004154730](//assets/Pasted_image_20241004154730.webp)
### Appendix 2 – Windows Server Scan

![Pasted_image_20241004154808](//assets/Pasted_image_20241004154808.webp)
### Appendix 3 – Ubuntu Linux Vulnerability Scan

![Pasted_image_20241004154824](//assets/Pasted_image_20241004154824.webp)
![Pasted_image_20241004154832](//assets/Pasted_image_20241004154832.webp)

### Appendix 4 – Linux (3.2-4.9) Service Scan

![Pasted_image_20241004154847](//assets/Pasted_image_20241004154847.webp)

### Appendix 5 – Linux (3.2-4.9) Vulnerability Scan

![Pasted_image_20241004155031](//assets/Pasted_image_20241004155031.webp)
![Pasted_image_20241004155036](//assets/Pasted_image_20241004155036.webp)
![Pasted_image_20241004155041](//assets/Pasted_image_20241004155041.webp)
![Pasted_image_20241004155048](//assets/Pasted_image_20241004155048.webp)


### Appendix 6 – Linux (2.6.x) Service scan

![Pasted_image_20241004155204](//assets/Pasted_image_20241004155204.webp)

### Appendix 7 – Linux (2.6.x) Vulnerability Scan
![Pasted_image_20241004155320](//assets/Pasted_image_20241004155320.webp)
![Pasted_image_20241004155324](//assets/Pasted_image_20241004155324.webp)
![Pasted_image_20241004155328](//assets/Pasted_image_20241004155328.webp)
![Pasted_image_20241004155335](//assets/Pasted_image_20241004155335.webp)
![Pasted_image_20241004155340](//assets/Pasted_image_20241004155340.webp)

### Appendix 8 – Android Scan

![Pasted_image_20241004155356](//assets/Pasted_image_20241004155356.webp)
